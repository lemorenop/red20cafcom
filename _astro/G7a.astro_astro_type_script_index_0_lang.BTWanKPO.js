import{B as y,f as g,w as f}from"./BaseChart.BPIYNeR_.js";import{g as h}from"./colors.DR0mxEkc.js";class C extends y{getDefaultCountries(){return["Argentina","Brasil","Chile","Colombia","Costa Rica","Ecuador","México","Perú","Uruguay","Antigua y Barbuda","Jamaica","Trinidad y Tobago","Francia","Alemania","Japón","Corea","Reino Unido","Estados Unidos"].map(a=>this.t(a))}averageIndices={};averageByRegion=null;getAverageDataByRegion(a){return this.averageByRegion||(this.averageByRegion={},["Promedio América Latina","Promedio Caribe","Promedio OCDE"].map(t=>this.t(t)).forEach(t=>{const n=this.rawData.find(s=>s.country===t);this.averageByRegion[n.region]=n})),this.averageByRegion[a]}colorByRegion=null;getColorByRegion(a){if(!this.colorByRegion){const i=["América Latina","Caribe","OCDE"].map(n=>this.t(n)),t=[h(0),h(3),h(2)];this.colorByRegion=Object.fromEntries(i.map((n,s)=>[n,t[s]]))}return this.colorByRegion[a]}async initialize(){await super.initialize(),this.setupCountriesSelect(),this.updateChart()}setupCountriesSelect(){const a=[...new Set(this.rawData.map(t=>t.country).filter(t=>!t.startsWith(this.t("Promedio"))))].sort(),i=this.getDefaultCountries();this.countriesSelect=document.querySelector(`#countries-select-list-${this.chartId}`),this.countriesSelect&&a.forEach(t=>{const n=document.createElement("li"),s=document.createElement("label");s.classList.add("label","cursor-pointer");const o=document.createElement("span");o.classList.add("label-text"),o.textContent=t;const c=document.createElement("input");c.type="checkbox",c.classList.add("checkbox","checkbox-primary","checkbox-sm"),c.value=t,i.includes(t)&&(c.checked=!0),s.appendChild(o),s.appendChild(c),n.appendChild(s),n.addEventListener("change",()=>this.updateChart()),this.countriesSelect.appendChild(n)})}updateChart(){const a=Array.from(this.countriesSelect.querySelectorAll("input:checked")).map(i=>i.value);a.length>0?(this.chart.data=this.getDataFromCountries(a),this.chart.legendNeedsUpdate=!0,this.chart.update()):(this.chart.data.datasets.splice(0,1/0),this.chart.data.labels.splice(0,1/0),this.chart.legendNeedsUpdate=!0,this.chart.update())}getDataFromCountries(a){const i=this.rawData.filter(e=>a.includes(e.country)),t=i.reduce((e,r)=>(e[r.region]||(e[r.region]=[]),e[r.region].push(r),e),{});for(const e in t){t[e].sort((u,d)=>d.percentage-u.percentage);const r=this.getAverageDataByRegion(e);(r.percentage!==void 0||r.percentage!==null)&&t[e].push(this.getAverageDataByRegion(e))}i.length=0;const n=Object.keys(t).sort();for(const e of n)i.push(...t[e]);const s=[],o={};for(const e of n)o[e]=t[e].length;const c=Object.values(o).reduce((e,r)=>e+r,0);let l=0;return n.forEach(e=>{const r=Array(c).fill(null);t[e].forEach((u,d)=>{r[l+d]=u.percentage}),s.push({label:e,data:r,backgroundColor:this.getColorByRegion(e),pointStyle:"rect"}),l+=o[e],this.averageByRegion[e]!==null&&(this.averageIndices[e]=l-1)}),{labels:i.map(e=>e.country),datasets:s}}getType(){return"bar"}getData(){return[]}getOptions(){return this.mergeOptions(super.getOptions(),{layout:{padding:{top:12}},scales:{x:{stacked:!0,ticks:{minRotation:90,maxRotation:90,autoSkip:!1}},y:{}},plugins:{tooltip:{boxPadding:4,callbacks:{title(){return""},label:a=>{const i=g(a.dataset.data[a.dataIndex],this.getFormatOptions());return`${this.t("Capacidad burocrática y administrativa")}: ${i}`}}},datalabels:{anchor:"end",align:"top",rotation:"-90",offset:4,formatter:(a,i)=>a&&Object.values(this.averageIndices).includes(i.dataIndex)?g(a,this.getFormatOptions()):null}}})}getPlugins(){return[...super.getPlugins(),f]}}function p(){try{new C("C5-G7a")}catch{}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",p):p();
