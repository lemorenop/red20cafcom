import{i as R,a as L,C as st,E as T,t as C,d as yt,b as w,c as G,P as p,e as ke,u as Ae,g as j,R as Gt,h as Pe,j as De,D as ve,A as Ee,v as $,k as Qt,l as pt,Q as X,H as q,T as At,m as Zt,n as Te,o as Pt,p as at,q as Dt,r as Oe,B as Ie,s as vt,f as Et,w as je}from"./BaseChart.BPIYNeR_.js";import{M as Re,a as Le}from"./chartjs-chart-matrix.esm.Do3SLBbg.js";/*!
* chartjs-plugin-annotation v3.1.0
* https://www.chartjs.org/chartjs-plugin-annotation/index
 * (c) 2024 chartjs-plugin-annotation Contributors
 * Released under the MIT License
 */const Tt={modes:{point(e,t){return J(e,t,{intersect:!0})},nearest(e,t,n){return _e(e,t,n)},x(e,t,n){return J(e,t,{intersect:n.intersect,axis:"x"})},y(e,t,n){return J(e,t,{intersect:n.intersect,axis:"y"})}}};function mt(e,t,n){return(Tt.modes[n.mode]||Tt.modes.nearest)(e,t,n)}function ze(e,t,n){return n!=="x"&&n!=="y"?e.inRange(t.x,t.y,"x",!0)||e.inRange(t.x,t.y,"y",!0):e.inRange(t.x,t.y,n,!0)}function Ye(e,t,n){return n==="x"?{x:e.x,y:t.y}:n==="y"?{x:t.x,y:e.y}:t}function J(e,t,n){return e.filter(o=>n.intersect?o.inRange(t.x,t.y):ze(o,t,n.axis))}function _e(e,t,n){let o=Number.POSITIVE_INFINITY;return J(e,t,n).reduce((r,s)=>{const i=s.getCenterPoint(),a=Ye(t,i,n.axis),d=yt(t,a);return d<o?(r=[s],o=d):d===o&&r.push(s),r},[]).sort((r,s)=>r._index-s._index).slice(0,1)}function O(e,t,n){const o=Math.cos(n),r=Math.sin(n),s=t.x,i=t.y;return{x:s+o*(e.x-s)-r*(e.y-i),y:i+r*(e.x-s)+o*(e.y-i)}}const We=(e,t)=>t>e||e.length>t.length&&e.slice(0,t.length)===t,v=.001,Q=(e,t,n)=>Math.min(n,Math.max(t,e)),te=(e,t)=>e.value>=e.start-t&&e.value<=e.end+t;function Xe(e,t,n){for(const o of Object.keys(e))e[o]=Q(e[o],t,n);return e}function He(e,t,n,o){return!e||!t||n<=0?!1:Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)<=Math.pow(n+o,2)}function ee(e,{x:t,y:n,x2:o,y2:r},s,{borderWidth:i,hitTolerance:a}){const d=(i+a)/2,l=e.x>=t-d-v&&e.x<=o+d+v,c=e.y>=n-d-v&&e.y<=r+d+v;return s==="x"?l:(s==="y"||l)&&c}function ne(e,{rect:t,center:n},o,{rotation:r,borderWidth:s,hitTolerance:i}){const a=O(e,n,C(-r));return ee(a,t,o,{borderWidth:s,hitTolerance:i})}function I(e,t){const{centerX:n,centerY:o}=e.getProps(["centerX","centerY"],t);return{x:n,y:o}}function Be(e,t,n,o=!0){const r=n.split(".");let s=0;for(const i of t.split(".")){const a=r[s++];if(parseInt(i,10)<parseInt(a,10))break;if(We(a,i)){if(o)throw new Error(`${e} v${n} is not supported. v${t} or newer is required.`);return!1}}return!0}const oe=e=>typeof e=="string"&&e.endsWith("%"),re=e=>parseFloat(e)/100,ie=e=>Q(re(e),0,1),H=(e,t)=>({x:e,y:t,x2:e,y2:t,width:0,height:0}),Ne={box:e=>H(e.centerX,e.centerY),doughnutLabel:e=>H(e.centerX,e.centerY),ellipse:e=>({centerX:e.centerX,centerY:e.centerX,radius:0,width:0,height:0}),label:e=>H(e.centerX,e.centerY),line:e=>H(e.x,e.y),point:e=>({centerX:e.centerX,centerY:e.centerY,radius:0,width:0,height:0}),polygon:e=>H(e.centerX,e.centerY)};function wt(e,t){return t==="start"?0:t==="end"?e:oe(t)?ie(t)*e:e/2}function P(e,t,n=!0){return typeof t=="number"?t:oe(t)?(n?ie(t):re(t))*e:e}function $e(e,t){const{x:n,width:o}=e,r=t.textAlign;return r==="center"?n+o/2:r==="end"||r==="right"?n+o:n}function se(e,t,{borderWidth:n,position:o,xAdjust:r,yAdjust:s},i){const a=R(i),d=t.width+(a?i.width:0)+n,l=t.height+(a?i.height:0)+n,c=xt(o),u=Ot(e.x,d,r,c.x),f=Ot(e.y,l,s,c.y);return{x:u,y:f,x2:u+d,y2:f+l,width:d,height:l,centerX:u+d/2,centerY:f+l/2}}function xt(e,t="center"){return R(e)?{x:$(e.x,t),y:$(e.y,t)}:(e=$(e,t),{x:e,y:e})}const ae=(e,t)=>e&&e.autoFit&&t<1;function de(e,t){const n=e.font,o=L(n)?n:[n];return ae(e,t)?o.map(function(r){const s=at(r);return s.size=Math.floor(r.size*t),s.lineHeight=r.lineHeight,at(s)}):o.map(r=>at(r))}function le(e){return e&&(w(e.xValue)||w(e.yValue))}function Ot(e,t,n=0,o){return e-wt(t,o)+n}function Y(e,t,n){const o=n.init;if(o){if(o===!0)return ue(t,n)}else return;return Ve(e,t,n)}function ce(e,t,n){let o=!1;return t.forEach(r=>{j(e[r])?(o=!0,n[r]=e[r]):w(n[r])&&delete n[r]}),o}function ue(e,t){const n=t.type||"line";return Ne[n](e)}function Ve(e,t,n){const o=pt(n.init,[{chart:e,properties:t,options:n}]);if(o===!0)return ue(t,n);if(R(o))return o}const dt=new Map,Ue=e=>isNaN(e)||e<=0,Fe=e=>e.reduce(function(t,n){return t+=n.string,t},"");function Z(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object HTMLImageElement]"||t==="[object HTMLCanvasElement]"}}function tt(e,{x:t,y:n},o){o&&(e.translate(t,n),e.rotate(C(o)),e.translate(-t,-n))}function x(e,t){if(t&&t.borderWidth)return e.lineCap=t.borderCapStyle||"butt",e.setLineDash(t.borderDash),e.lineDashOffset=t.borderDashOffset,e.lineJoin=t.borderJoinStyle||"miter",e.lineWidth=t.borderWidth,e.strokeStyle=t.borderColor,!0}function _(e,t){e.shadowColor=t.backgroundShadowColor,e.shadowBlur=t.shadowBlur,e.shadowOffsetX=t.shadowOffsetX,e.shadowOffsetY=t.shadowOffsetY}function et(e,t){const n=t.content;if(Z(n))return{width:P(n.width,t.width),height:P(n.height,t.height)};const o=de(t),r=t.textStrokeWidth,s=L(n)?n:[n],i=s.join()+Fe(o)+r+(e._measureText?"-spriting":"");return dt.has(i)||dt.set(i,Ge(e,s,o,r)),dt.get(i)}function fe(e,t,n){const{x:o,y:r,width:s,height:i}=t;e.save(),_(e,n);const a=x(e,n);e.fillStyle=n.backgroundColor,e.beginPath(),Pe(e,{x:o,y:r,w:s,h:i,radius:Xe(De(n.borderRadius),0,Math.min(s,i)/2)}),e.closePath(),e.fill(),a&&(e.shadowColor=n.borderShadowColor,e.stroke()),e.restore()}function he(e,t,n,o){const r=n.content;if(Z(r)){e.save(),e.globalAlpha=tn(n.opacity,r.style.opacity),e.drawImage(r,t.x,t.y,t.width,t.height),e.restore();return}const s=L(r)?r:[r],i=de(n,o),a=n.color,d=L(a)?a:[a],l=$e(t,n),c=t.y+n.textStrokeWidth/2;e.save(),e.textBaseline="middle",e.textAlign=n.textAlign,qe(e,n)&&Qe(e,{x:l,y:c},s,i),Ze(e,{x:l,y:c},s,{fonts:i,colors:d}),e.restore()}function qe(e,t){if(t.textStrokeWidth>0)return e.lineJoin="round",e.miterLimit=2,e.lineWidth=t.textStrokeWidth,e.strokeStyle=t.textStrokeColor,!0}function Je(e,t,n,o){const{radius:r,options:s}=t,i=s.pointStyle,a=s.rotation;let d=(a||0)*Gt;if(Z(i)){e.save(),e.translate(n,o),e.rotate(d),e.drawImage(i,-i.width/2,-i.height/2,i.width,i.height),e.restore();return}Ue(r)||Ke(e,{x:n,y:o,radius:r,rotation:a,style:i,rad:d})}function Ke(e,{x:t,y:n,radius:o,rotation:r,style:s,rad:i}){let a,d,l,c;switch(e.beginPath(),s){default:e.arc(t,n,o,0,Zt),e.closePath();break;case"triangle":e.moveTo(t+Math.sin(i)*o,n-Math.cos(i)*o),i+=At,e.lineTo(t+Math.sin(i)*o,n-Math.cos(i)*o),i+=At,e.lineTo(t+Math.sin(i)*o,n-Math.cos(i)*o),e.closePath();break;case"rectRounded":c=o*.516,l=o-c,a=Math.cos(i+X)*l,d=Math.sin(i+X)*l,e.arc(t-a,n-d,c,i-p,i-q),e.arc(t+d,n-a,c,i-q,i),e.arc(t+a,n+d,c,i,i+q),e.arc(t-d,n+a,c,i+q,i+p),e.closePath();break;case"rect":if(!r){l=Math.SQRT1_2*o,e.rect(t-l,n-l,2*l,2*l);break}i+=X;case"rectRot":a=Math.cos(i)*o,d=Math.sin(i)*o,e.moveTo(t-a,n-d),e.lineTo(t+d,n-a),e.lineTo(t+a,n+d),e.lineTo(t-d,n+a),e.closePath();break;case"crossRot":i+=X;case"cross":a=Math.cos(i)*o,d=Math.sin(i)*o,e.moveTo(t-a,n-d),e.lineTo(t+a,n+d),e.moveTo(t+d,n-a),e.lineTo(t-d,n+a);break;case"star":a=Math.cos(i)*o,d=Math.sin(i)*o,e.moveTo(t-a,n-d),e.lineTo(t+a,n+d),e.moveTo(t+d,n-a),e.lineTo(t-d,n+a),i+=X,a=Math.cos(i)*o,d=Math.sin(i)*o,e.moveTo(t-a,n-d),e.lineTo(t+a,n+d),e.moveTo(t+d,n-a),e.lineTo(t-d,n+a);break;case"line":a=Math.cos(i)*o,d=Math.sin(i)*o,e.moveTo(t-a,n-d),e.lineTo(t+a,n+d);break;case"dash":e.moveTo(t,n),e.lineTo(t+Math.cos(i)*o,n+Math.sin(i)*o);break}e.fill()}function Ge(e,t,n,o){e.save();const r=t.length;let s=0,i=o;for(let a=0;a<r;a++){const d=n[Math.min(a,n.length-1)];e.font=d.string;const l=t[a];s=Math.max(s,e.measureText(l).width+o),i+=d.lineHeight}return e.restore(),{width:s,height:i}}function Qe(e,{x:t,y:n},o,r){e.beginPath();let s=0;o.forEach(function(i,a){const d=r[Math.min(a,r.length-1)],l=d.lineHeight;e.font=d.string,e.strokeText(i,t,n+l/2+s),s+=l}),e.stroke()}function Ze(e,{x:t,y:n},o,{fonts:r,colors:s}){let i=0;o.forEach(function(a,d){const l=s[Math.min(d,s.length-1)],c=r[Math.min(d,r.length-1)],u=c.lineHeight;e.beginPath(),e.font=c.string,e.fillStyle=l,e.fillText(a,t,n+u/2+i),i+=u,e.fill()})}function tn(e,t){const n=Pt(e)?e:t;return Pt(n)?Q(n,0,1):1}const ge=["left","bottom","top","right"];function en(e,t){const{pointX:n,pointY:o,options:r}=t,s=r.callout,i=s&&s.display&&an(t,s);if(!i||ln(t,s,i))return;if(e.save(),e.beginPath(),!x(e,s))return e.restore();const{separatorStart:d,separatorEnd:l}=nn(t,i),{sideStart:c,sideEnd:u}=rn(t,i,d);(s.margin>0||r.borderWidth===0)&&(e.moveTo(d.x,d.y),e.lineTo(l.x,l.y)),e.moveTo(c.x,c.y),e.lineTo(u.x,u.y);const f=O({x:n,y:o},t.getCenterPoint(),C(-t.rotation));e.lineTo(f.x,f.y),e.stroke(),e.restore()}function nn(e,t){const{x:n,y:o,x2:r,y2:s}=e,i=on(e,t);let a,d;return t==="left"||t==="right"?(a={x:n+i,y:o},d={x:a.x,y:s}):(a={x:n,y:o+i},d={x:r,y:a.y}),{separatorStart:a,separatorEnd:d}}function on(e,t){const{width:n,height:o,options:r}=e,s=r.callout.margin+r.borderWidth/2;return t==="right"?n+s:t==="bottom"?o+s:-s}function rn(e,t,n){const{y:o,width:r,height:s,options:i}=e,a=i.callout.start,d=sn(t,i.callout);let l,c;return t==="left"||t==="right"?(l={x:n.x,y:o+P(s,a)},c={x:l.x+d,y:l.y}):(l={x:n.x+P(r,a),y:n.y},c={x:l.x,y:l.y+d}),{sideStart:l,sideEnd:c}}function sn(e,t){const n=t.side;return e==="left"||e==="top"?-n:n}function an(e,t){const n=t.position;return ge.includes(n)?n:dn(e,t)}function dn(e,t){const{x:n,y:o,x2:r,y2:s,width:i,height:a,pointX:d,pointY:l,centerX:c,centerY:u,rotation:f}=e,h={x:c,y:u},g=t.start,m=P(i,g),S=P(a,g),b=[n,n+m,n+m,r],y=[o+S,s,o,s],M=[];for(let D=0;D<4;D++){const it=O({x:b[D],y:y[D]},h,C(f));M.push({position:ge[D],distance:yt(it,{x:d,y:l})})}return M.sort((D,it)=>D.distance-it.distance)[0].position}function ln(e,t,n){const{pointX:o,pointY:r}=e,s=t.margin;let i=o,a=r;return n==="left"?i+=s:n==="right"?i-=s:n==="top"?a+=s:n==="bottom"&&(a-=s),e.inRange(i,a)}const It={xScaleID:{min:"xMin",max:"xMax",start:"left",end:"right",startProp:"x",endProp:"x2"},yScaleID:{min:"yMin",max:"yMax",start:"bottom",end:"top",startProp:"y",endProp:"y2"}};function z(e,t,n){return t=typeof t=="number"?t:e.parse(t),Qt(t)?e.getPixelForValue(t):n}function E(e,t,n){const o=t[n];if(o||n==="scaleID")return o;const r=n.charAt(0),s=Object.values(e).filter(i=>i.axis&&i.axis===r);return s.length?s[0].id:r}function be(e,t){if(e){const n=e.options.reverse,o=z(e,t.min,n?t.end:t.start),r=z(e,t.max,n?t.start:t.end);return{start:o,end:r}}}function ye(e,t){const{chartArea:n,scales:o}=e,r=o[E(o,t,"xScaleID")],s=o[E(o,t,"yScaleID")];let i=n.width/2,a=n.height/2;return r&&(i=z(r,t.xValue,r.left+r.width/2)),s&&(a=z(s,t.yValue,s.top+s.height/2)),{x:i,y:a}}function Ct(e,t){const n=e.scales,o=n[E(n,t,"xScaleID")],r=n[E(n,t,"yScaleID")];if(!o&&!r)return{};let{left:s,right:i}=o||e.chartArea,{top:a,bottom:d}=r||e.chartArea;const l=jt(o,{min:t.xMin,max:t.xMax,start:s,end:i});s=l.start,i=l.end;const c=jt(r,{min:t.yMin,max:t.yMax,start:d,end:a});return a=c.start,d=c.end,{x:s,y:a,x2:i,y2:d,width:i-s,height:d-a,centerX:s+(i-s)/2,centerY:a+(d-a)/2}}function pe(e,t){if(!le(t)){const n=Ct(e,t);let o=t.radius;(!o||isNaN(o))&&(o=Math.min(n.width,n.height)/2,t.radius=o);const r=o*2,s=n.centerX+t.xAdjust,i=n.centerY+t.yAdjust;return{x:s-o,y:i-o,x2:s+o,y2:i+o,centerX:s,centerY:i,width:r,height:r,radius:o}}return un(e,t)}function cn(e,t){const{scales:n,chartArea:o}=e,r=n[t.scaleID],s={x:o.left,y:o.top,x2:o.right,y2:o.bottom};return r?fn(r,s,t):hn(n,s,t),s}function me(e,t){const n=Ct(e,t);return n.initProperties=Y(e,n,t),n.elements=[{type:"label",optionScope:"label",properties:yn(e,n,t),initProperties:n.initProperties}],n}function un(e,t){const n=ye(e,t),o=t.radius*2;return{x:n.x-t.radius+t.xAdjust,y:n.y-t.radius+t.yAdjust,x2:n.x+t.radius+t.xAdjust,y2:n.y+t.radius+t.yAdjust,centerX:n.x+t.xAdjust,centerY:n.y+t.yAdjust,radius:t.radius,width:o,height:o}}function jt(e,t){const n=be(e,t)||t;return{start:Math.min(n.start,n.end),end:Math.max(n.start,n.end)}}function fn(e,t,n){const o=z(e,n.value,NaN),r=z(e,n.endValue,o);e.isHorizontal()?(t.x=o,t.x2=r):(t.y=o,t.y2=r)}function hn(e,t,n){for(const o of Object.keys(It)){const r=e[E(e,n,o)];if(r){const{min:s,max:i,start:a,end:d,startProp:l,endProp:c}=It[o],u=be(r,{min:n[s],max:n[i],start:r[a],end:r[d]});t[l]=u.start,t[c]=u.end}}}function gn({properties:e,options:t},n,o,r){const{x:s,x2:i,width:a}=e;return we({start:s,end:i,borderWidth:t.borderWidth},{position:o.x,padding:{start:r.left,end:r.right},adjust:t.label.xAdjust,size:n.width})}function bn({properties:e,options:t},n,o,r){const{y:s,y2:i,height:a}=e;return we({start:s,end:i,borderWidth:t.borderWidth},{position:o.y,padding:{start:r.top,end:r.bottom},adjust:t.label.yAdjust,size:n.height})}function we(e,t){const{start:n,end:o,borderWidth:r}=e,{position:s,padding:{start:i,end:a},adjust:d}=t,l=o-r-n-i-a-t.size;return n+r/2+d+wt(l,s)}function yn(e,t,n){const o=n.label;o.backgroundColor="transparent",o.callout.display=!1;const r=xt(o.position),s=G(o.padding),i=et(e.ctx,o),a=gn({properties:t,options:n},i,r,s),d=bn({properties:t,options:n},i,r,s),l=i.width+s.width,c=i.height+s.height;return{x:a,y:d,x2:a+l,y2:d+c,width:l,height:c,centerX:a+l/2,centerY:d+c/2,rotation:o.rotation}}const lt=["enter","leave"],St=lt.concat("click");function pn(e,t,n){t.listened=ce(n,St,t.listeners),t.moveListened=!1,lt.forEach(o=>{j(n[o])&&(t.moveListened=!0)}),(!t.listened||!t.moveListened)&&t.annotations.forEach(o=>{!t.listened&&j(o.click)&&(t.listened=!0),t.moveListened||lt.forEach(r=>{j(o[r])&&(t.listened=!0,t.moveListened=!0)})})}function mn(e,t,n){if(e.listened)switch(t.type){case"mousemove":case"mouseout":return wn(e,t,n);case"click":return xn(e,t,n)}}function wn(e,t,n){if(!e.moveListened)return;let o;t.type==="mousemove"?o=mt(e.visibleElements,t,n.interaction):o=[];const r=e.hovered;e.hovered=o;const s={state:e,event:t};let i=Rt(s,"leave",r,o);return Rt(s,"enter",o,r)||i}function Rt({state:e,event:t},n,o,r){let s;for(const i of o)r.indexOf(i)<0&&(s=xe(i.options[n]||e.listeners[n],i,t)||s);return s}function xn(e,t,n){const o=e.listeners,r=mt(e.visibleElements,t,n.interaction);let s;for(const i of r)s=xe(i.options.click||o.click,i,t)||s;return s}function xe(e,t,n){return pt(e,[t.$context,n])===!0}const K=["afterDraw","beforeDraw"];function Cn(e,t,n){const o=t.visibleElements;t.hooked=ce(n,K,t.hooks),t.hooked||o.forEach(r=>{t.hooked||K.forEach(s=>{j(r.options[s])&&(t.hooked=!0)})})}function Lt(e,t,n){if(e.hooked){const o=t.options[n]||e.hooks[n];return pt(o,[t.$context])}}function Sn(e,t,n){const o=Dn(e.scales,t,n);let r=zt(t,o,"min","suggestedMin");r=zt(t,o,"max","suggestedMax")||r,r&&j(t.handleTickRangeOptions)&&t.handleTickRangeOptions()}function Mn(e,t){for(const n of e)An(n,t)}function zt(e,t,n,o){if(Qt(t[n])&&!kn(e.options,n,o)){const r=e[n]!==t[n];return e[n]=t[n],r}}function kn(e,t,n){return w(e[t])||w(e[n])}function An(e,t){for(const n of["scaleID","xScaleID","yScaleID"]){const o=E(t,e,n);o&&!t[o]&&Pn(e,n)&&console.warn(`No scale found with id '${o}' for annotation '${e.id}'`)}}function Pn(e,t){if(t==="scaleID")return!0;const n=t.charAt(0);for(const o of["Min","Max","Value"])if(w(e[n+o]))return!0;return!1}function Dn(e,t,n){const o=t.axis,r=t.id,s=o+"ScaleID",i={min:$(t.min,Number.NEGATIVE_INFINITY),max:$(t.max,Number.POSITIVE_INFINITY)};for(const a of n)a.scaleID===r?Yt(a,t,["value","endValue"],i):E(e,a,s)===r&&Yt(a,t,[o+"Min",o+"Max",o+"Value"],i);return i}function Yt(e,t,n,o){for(const r of n){const s=e[r];if(w(s)){const i=t.parse(s);o.min=Math.min(o.min,i),o.max=Math.max(o.max,i)}}}class W extends T{inRange(t,n,o,r){const{x:s,y:i}=O({x:t,y:n},this.getCenterPoint(r),C(-this.options.rotation));return ee({x:s,y:i},this.getProps(["x","y","x2","y2"],r),o,this.options)}getCenterPoint(t){return I(this,t)}draw(t){t.save(),tt(t,this.getCenterPoint(),this.options.rotation),fe(t,this,this.options),t.restore()}get label(){return this.elements&&this.elements[0]}resolveElementProperties(t,n){return me(t,n)}}W.id="boxAnnotation";W.defaults={adjustScaleRange:!0,backgroundShadowColor:"transparent",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderRadius:0,borderShadowColor:"transparent",borderWidth:1,display:!0,init:void 0,hitTolerance:0,label:{backgroundColor:"transparent",borderWidth:0,callout:{display:!1},color:"black",content:null,display:!1,drawTime:void 0,font:{family:void 0,lineHeight:void 0,size:void 0,style:void 0,weight:"bold"},height:void 0,hitTolerance:void 0,opacity:void 0,padding:6,position:"center",rotation:void 0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,width:void 0,xAdjust:0,yAdjust:0,z:void 0},rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,xMax:void 0,xMin:void 0,xScaleID:void 0,yMax:void 0,yMin:void 0,yScaleID:void 0,z:0};W.defaultRoutes={borderColor:"color",backgroundColor:"color"};W.descriptors={label:{_fallback:!0}};class nt extends T{inRange(t,n,o,r){return ne({x:t,y:n},{rect:this.getProps(["x","y","x2","y2"],r),center:this.getCenterPoint(r)},o,{rotation:this.rotation,borderWidth:0,hitTolerance:this.options.hitTolerance})}getCenterPoint(t){return I(this,t)}draw(t){const n=this.options;!n.display||!n.content||(jn(t,this),t.save(),tt(t,this.getCenterPoint(),this.rotation),he(t,this,n,this._fitRatio),t.restore())}resolveElementProperties(t,n){const o=vn(t,n);if(!o)return{};const{controllerMeta:r,point:s,radius:i}=Tn(t,n,o);let a=et(t.ctx,n);const d=On(a,i);ae(n,d)&&(a={width:a.width*d,height:a.height*d});const{position:l,xAdjust:c,yAdjust:u}=n,f=se(s,a,{borderWidth:0,position:l,xAdjust:c,yAdjust:u});return{initProperties:Y(t,f,n),...f,...r,rotation:n.rotation,_fitRatio:d}}}nt.id="doughnutLabelAnnotation";nt.defaults={autoFit:!0,autoHide:!0,backgroundColor:"transparent",backgroundShadowColor:"transparent",borderColor:"transparent",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderShadowColor:"transparent",borderWidth:0,color:"black",content:null,display:!0,font:{family:void 0,lineHeight:void 0,size:void 0,style:void 0,weight:void 0},height:void 0,hitTolerance:0,init:void 0,opacity:void 0,position:"center",rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,spacing:1,textAlign:"center",textStrokeColor:void 0,textStrokeWidth:0,width:void 0,xAdjust:0,yAdjust:0};nt.defaultRoutes={};function vn(e,t){return e.getSortedVisibleDatasetMetas().reduce(function(n,o){const r=o.controller;return r instanceof ve&&En(e,t,o.data)&&(!n||r.innerRadius<n.controller.innerRadius)&&r.options.circumference>=90?o:n},void 0)}function En(e,t,n){if(!t.autoHide)return!0;for(let o=0;o<n.length;o++)if(!n[o].hidden&&e.getDataVisibility(o))return!0}function Tn({chartArea:e},t,n){const{left:o,top:r,right:s,bottom:i}=e,{innerRadius:a,offsetX:d,offsetY:l}=n.controller,c=(o+s)/2+d,u=(r+i)/2+l,f={left:Math.max(c-a,o),right:Math.min(c+a,s),top:Math.max(u-a,r),bottom:Math.min(u+a,i)},h={x:(f.left+f.right)/2,y:(f.top+f.bottom)/2},g=t.spacing+t.borderWidth/2,m=a-g,S=h.y>u,b=S?r+g:i-g,y=In(b,c,u,m);return{controllerMeta:{_centerX:c,_centerY:u,_radius:m,_counterclockwise:S,...y},point:h,radius:Math.min(a,Math.min(f.right-f.left,f.bottom-f.top)/2)}}function On({width:e,height:t},n){const o=Math.sqrt(Math.pow(e,2)+Math.pow(t,2));return n*2/o}function In(e,t,n,o){const r=Math.pow(n-e,2),s=Math.pow(o,2),i=t*-2,a=Math.pow(t,2)+r-s,d=Math.pow(i,2)-4*a;if(d<=0)return{_startAngle:0,_endAngle:Zt};const l=(-i-Math.sqrt(d))/2,c=(-i+Math.sqrt(d))/2;return{_startAngle:Dt({x:t,y:n},{x:l,y:e}).angle,_endAngle:Dt({x:t,y:n},{x:c,y:e}).angle}}function jn(e,t){const{_centerX:n,_centerY:o,_radius:r,_startAngle:s,_endAngle:i,_counterclockwise:a,options:d}=t;e.save();const l=x(e,d);e.fillStyle=d.backgroundColor,e.beginPath(),e.arc(n,o,r,s,i,a),e.closePath(),e.fill(),l&&e.stroke(),e.restore()}class V extends T{inRange(t,n,o,r){return ne({x:t,y:n},{rect:this.getProps(["x","y","x2","y2"],r),center:this.getCenterPoint(r)},o,{rotation:this.rotation,borderWidth:this.options.borderWidth,hitTolerance:this.options.hitTolerance})}getCenterPoint(t){return I(this,t)}draw(t){const n=this.options,o=!w(this._visible)||this._visible;!n.display||!n.content||!o||(t.save(),tt(t,this.getCenterPoint(),this.rotation),en(t,this),fe(t,this,n),he(t,Rn(this),n),t.restore())}resolveElementProperties(t,n){let o;if(le(n))o=ye(t,n);else{const{centerX:a,centerY:d}=Ct(t,n);o={x:a,y:d}}const r=G(n.padding),s=et(t.ctx,n),i=se(o,s,n,r);return{initProperties:Y(t,i,n),pointX:o.x,pointY:o.y,...i,rotation:n.rotation}}}V.id="labelAnnotation";V.defaults={adjustScaleRange:!0,backgroundColor:"transparent",backgroundShadowColor:"transparent",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderRadius:0,borderShadowColor:"transparent",borderWidth:0,callout:{borderCapStyle:"butt",borderColor:void 0,borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:1,display:!1,margin:5,position:"auto",side:5,start:"50%"},color:"black",content:null,display:!0,font:{family:void 0,lineHeight:void 0,size:void 0,style:void 0,weight:void 0},height:void 0,hitTolerance:0,init:void 0,opacity:void 0,padding:6,position:"center",rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,textAlign:"center",textStrokeColor:void 0,textStrokeWidth:0,width:void 0,xAdjust:0,xMax:void 0,xMin:void 0,xScaleID:void 0,xValue:void 0,yAdjust:0,yMax:void 0,yMin:void 0,yScaleID:void 0,yValue:void 0,z:0};V.defaultRoutes={borderColor:"color"};function Rn({x:e,y:t,width:n,height:o,options:r}){const s=r.borderWidth/2,i=G(r.padding);return{x:e+i.left+s,y:t+i.top+s,width:n-i.left-i.right-r.borderWidth,height:o-i.top-i.bottom-r.borderWidth}}const Mt=(e,t,n)=>({x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}),ct=(e,t,n)=>Mt(t,n,Math.abs((e-t.y)/(n.y-t.y))).x,_t=(e,t,n)=>Mt(t,n,Math.abs((e-t.x)/(n.x-t.x))).y,N=e=>e*e,Ln=(e,t,{x:n,y:o,x2:r,y2:s},i)=>i==="y"?{start:Math.min(o,s),end:Math.max(o,s),value:t}:{start:Math.min(n,r),end:Math.max(n,r),value:e},Wt=(e,t,n,o)=>(1-o)*(1-o)*e+2*(1-o)*o*t+o*o*n,ut=(e,t,n,o)=>({x:Wt(e.x,t.x,n.x,o),y:Wt(e.y,t.y,n.y,o)}),Xt=(e,t,n,o)=>2*(1-o)*(t-e)+2*o*(n-t),Ht=(e,t,n,o)=>-Math.atan2(Xt(e.x,t.x,n.x,o),Xt(e.y,t.y,n.y,o))+.5*p;class U extends T{inRange(t,n,o,r){const s=(this.options.borderWidth+this.options.hitTolerance)/2;if(o!=="x"&&o!=="y"){const i={mouseX:t,mouseY:n},{path:a,ctx:d}=this;if(a){x(d,this.options),d.lineWidth+=this.options.hitTolerance;const{chart:c}=this.$context,u=t*c.currentDevicePixelRatio,f=n*c.currentDevicePixelRatio,h=d.isPointInStroke(a,u,f)||ft(this,i,r);return d.restore(),h}const l=N(s);return Wn(this,i,l,r)||ft(this,i,r)}return zn(this,{mouseX:t,mouseY:n},o,{hitSize:s,useFinalPosition:r})}getCenterPoint(t){return I(this,t)}draw(t){const{x:n,y:o,x2:r,y2:s,cp:i,options:a}=this;if(t.save(),!x(t,a))return t.restore();_(t,a);const d=Math.sqrt(Math.pow(r-n,2)+Math.pow(s-o,2));if(a.curve&&i)return Fn(t,this,i,d),t.restore();const{startOpts:l,endOpts:c,startAdjust:u,endAdjust:f}=Ce(this),h=Math.atan2(s-o,r-n);t.translate(n,o),t.rotate(h),t.beginPath(),t.moveTo(0+u,0),t.lineTo(d-f,0),t.shadowColor=a.borderShadowColor,t.stroke(),ht(t,0,u,l),ht(t,d,-f,c),t.restore()}get label(){return this.elements&&this.elements[0]}resolveElementProperties(t,n){const o=cn(t,n),{x:r,y:s,x2:i,y2:a}=o,d=Yn(o,t.chartArea),l=d?_n({x:r,y:s},{x:i,y:a},t.chartArea):{x:r,y:s,x2:i,y2:a,width:Math.abs(i-r),height:Math.abs(a-s)};if(l.centerX=(i+r)/2,l.centerY=(a+s)/2,l.initProperties=Y(t,l,n),n.curve){const u={x:l.x,y:l.y},f={x:l.x2,y:l.y2};l.cp=Un(l,n,yt(u,f))}const c=Xn(t,l,n.label);return c._visible=d,l.elements=[{type:"label",optionScope:"label",properties:c,initProperties:l.initProperties}],l}}U.id="lineAnnotation";const Bt={backgroundColor:void 0,backgroundShadowColor:void 0,borderColor:void 0,borderDash:void 0,borderDashOffset:void 0,borderShadowColor:void 0,borderWidth:void 0,display:void 0,fill:void 0,length:void 0,shadowBlur:void 0,shadowOffsetX:void 0,shadowOffsetY:void 0,width:void 0};U.defaults={adjustScaleRange:!0,arrowHeads:{display:!1,end:Object.assign({},Bt),fill:!1,length:12,start:Object.assign({},Bt),width:6},borderDash:[],borderDashOffset:0,borderShadowColor:"transparent",borderWidth:2,curve:!1,controlPoint:{y:"-50%"},display:!0,endValue:void 0,init:void 0,hitTolerance:0,label:{backgroundColor:"rgba(0,0,0,0.8)",backgroundShadowColor:"transparent",borderCapStyle:"butt",borderColor:"black",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderRadius:6,borderShadowColor:"transparent",borderWidth:0,callout:Object.assign({},V.defaults.callout),color:"#fff",content:null,display:!1,drawTime:void 0,font:{family:void 0,lineHeight:void 0,size:void 0,style:void 0,weight:"bold"},height:void 0,hitTolerance:void 0,opacity:void 0,padding:6,position:"center",rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,textAlign:"center",textStrokeColor:void 0,textStrokeWidth:0,width:void 0,xAdjust:0,yAdjust:0,z:void 0},scaleID:void 0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,value:void 0,xMax:void 0,xMin:void 0,xScaleID:void 0,yMax:void 0,yMin:void 0,yScaleID:void 0,z:0};U.descriptors={arrowHeads:{start:{_fallback:!0},end:{_fallback:!0},_fallback:!0}};U.defaultRoutes={borderColor:"color"};function zn(e,{mouseX:t,mouseY:n},o,{hitSize:r,useFinalPosition:s}){const i=Ln(t,n,e.getProps(["x","y","x2","y2"],s),o);return te(i,r)||ft(e,{mouseX:t,mouseY:n},s,o)}function Yn({x:e,y:t,x2:n,y2:o},{top:r,right:s,bottom:i,left:a}){return!(e<a&&n<a||e>s&&n>s||t<r&&o<r||t>i&&o>i)}function Nt({x:e,y:t},n,{top:o,right:r,bottom:s,left:i}){return e<i&&(t=_t(i,{x:e,y:t},n),e=i),e>r&&(t=_t(r,{x:e,y:t},n),e=r),t<o&&(e=ct(o,{x:e,y:t},n),t=o),t>s&&(e=ct(s,{x:e,y:t},n),t=s),{x:e,y:t}}function _n(e,t,n){const{x:o,y:r}=Nt(e,t,n),{x:s,y:i}=Nt(t,e,n);return{x:o,y:r,x2:s,y2:i,width:Math.abs(s-o),height:Math.abs(i-r)}}function Wn(e,{mouseX:t,mouseY:n},o=v,r){const{x:s,y:i,x2:a,y2:d}=e.getProps(["x","y","x2","y2"],r),l=a-s,c=d-i,u=N(l)+N(c),f=u===0?-1:((t-s)*l+(n-i)*c)/u;let h,g;return f<0?(h=s,g=i):f>1?(h=a,g=d):(h=s+f*l,g=i+f*c),N(t-h)+N(n-g)<=o}function ft(e,{mouseX:t,mouseY:n},o,r){const s=e.label;return s.options.display&&s.inRange(t,n,r,o)}function Xn(e,t,n){const o=n.borderWidth,r=G(n.padding),s=et(e.ctx,n),i=s.width+r.width+o,a=s.height+r.height+o;return Bn(t,n,{width:i,height:a,padding:r},e.chartArea)}function Hn(e){const{x:t,y:n,x2:o,y2:r}=e,s=Math.atan2(r-n,o-t);return s>p/2?s-p:s<p/-2?s+p:s}function Bn(e,t,n,o){const{width:r,height:s,padding:i}=n,{xAdjust:a,yAdjust:d}=t,l={x:e.x,y:e.y},c={x:e.x2,y:e.y2},u=t.rotation==="auto"?Hn(e):C(t.rotation),f=Nn(r,s,u),h=$n(e,t,{labelSize:f,padding:i},o),g=e.cp?ut(l,e.cp,c,h):Mt(l,c,h),m={size:f.w,min:o.left,max:o.right,padding:i.left},S={size:f.h,min:o.top,max:o.bottom,padding:i.top},b=Vt(g.x,m)+a,y=Vt(g.y,S)+d;return{x:b-r/2,y:y-s/2,x2:b+r/2,y2:y+s/2,centerX:b,centerY:y,pointX:g.x,pointY:g.y,width:r,height:s,rotation:Te(u)}}function Nn(e,t,n){const o=Math.cos(n),r=Math.sin(n);return{w:Math.abs(e*o)+Math.abs(t*r),h:Math.abs(e*r)+Math.abs(t*o)}}function $n(e,t,n,o){let r;const s=Vn(e,o);return t.position==="start"?r=$t({w:e.x2-e.x,h:e.y2-e.y},n,t,s):t.position==="end"?r=1-$t({w:e.x-e.x2,h:e.y-e.y2},n,t,s):r=wt(1,t.position),r}function $t(e,t,n,o){const{labelSize:r,padding:s}=t,i=e.w*o.dx,a=e.h*o.dy,d=i>0&&(r.w/2+s.left-o.x)/i,l=a>0&&(r.h/2+s.top-o.y)/a;return Q(Math.max(d,l),0,.25)}function Vn(e,t){const{x:n,x2:o,y:r,y2:s}=e,i=Math.min(r,s)-t.top,a=Math.min(n,o)-t.left,d=t.bottom-Math.max(r,s),l=t.right-Math.max(n,o);return{x:Math.min(a,l),y:Math.min(i,d),dx:a<=l?1:-1,dy:i<=d?1:-1}}function Vt(e,t){const{size:n,min:o,max:r,padding:s}=t,i=n/2;return n>r-o?(r+o)/2:(o>=e-s-i&&(e=o+s+i),r<=e+s+i&&(e=r-s-i),e)}function Ce(e){const t=e.options,n=t.arrowHeads&&t.arrowHeads.start,o=t.arrowHeads&&t.arrowHeads.end;return{startOpts:n,endOpts:o,startAdjust:Ut(e,n),endAdjust:Ut(e,o)}}function Ut(e,t){if(!t||!t.display)return 0;const{length:n,width:o}=t,r=e.options.borderWidth/2,s={x:n,y:o+r};return Math.abs(ct(0,s,{x:0,y:r}))}function ht(e,t,n,o){if(!o||!o.display)return;const{length:r,width:s,fill:i,backgroundColor:a,borderColor:d}=o,l=Math.abs(t-r)+n;e.beginPath(),_(e,o),x(e,o),e.moveTo(l,-s),e.lineTo(t+n,0),e.lineTo(l,s),i===!0?(e.fillStyle=a||d,e.closePath(),e.fill(),e.shadowColor="transparent"):e.shadowColor=o.borderShadowColor,e.stroke()}function Un(e,t,n){const{x:o,y:r,x2:s,y2:i,centerX:a,centerY:d}=e,l=Math.atan2(i-r,s-o),c=xt(t.controlPoint,0),u={x:a+P(n,c.x,!1),y:d+P(n,c.y,!1)};return O(u,{x:a,y:d},l)}function Ft(e,{x:t,y:n},{angle:o,adjust:r},s){!s||!s.display||(e.save(),e.translate(t,n),e.rotate(o),ht(e,0,-r,s),e.restore())}function Fn(e,t,n,o){const{x:r,y:s,x2:i,y2:a,options:d}=t,{startOpts:l,endOpts:c,startAdjust:u,endAdjust:f}=Ce(t),h={x:r,y:s},g={x:i,y:a},m=Ht(h,n,g,0),S=Ht(h,n,g,1)-p,b=ut(h,n,g,u/o),y=ut(h,n,g,1-f/o),M=new Path2D;e.beginPath(),M.moveTo(b.x,b.y),M.quadraticCurveTo(n.x,n.y,y.x,y.y),e.shadowColor=d.borderShadowColor,e.stroke(M),t.path=M,t.ctx=e,Ft(e,b,{angle:m,adjust:u},l),Ft(e,y,{angle:S,adjust:f},c)}class F extends T{inRange(t,n,o,r){const s=this.options.rotation,i=(this.options.borderWidth+this.options.hitTolerance)/2;if(o!=="x"&&o!=="y")return qn({x:t,y:n},this.getProps(["width","height","centerX","centerY"],r),s,i);const{x:a,y:d,x2:l,y2:c}=this.getProps(["x","y","x2","y2"],r),u=o==="y"?{start:d,end:c}:{start:a,end:l},f=O({x:t,y:n},this.getCenterPoint(r),C(-s));return f[o]>=u.start-i-v&&f[o]<=u.end+i+v}getCenterPoint(t){return I(this,t)}draw(t){const{width:n,height:o,centerX:r,centerY:s,options:i}=this;t.save(),tt(t,this.getCenterPoint(),i.rotation),_(t,this.options),t.beginPath(),t.fillStyle=i.backgroundColor;const a=x(t,i);t.ellipse(r,s,o/2,n/2,p/2,0,2*p),t.fill(),a&&(t.shadowColor=i.borderShadowColor,t.stroke()),t.restore()}get label(){return this.elements&&this.elements[0]}resolveElementProperties(t,n){return me(t,n)}}F.id="ellipseAnnotation";F.defaults={adjustScaleRange:!0,backgroundShadowColor:"transparent",borderDash:[],borderDashOffset:0,borderShadowColor:"transparent",borderWidth:1,display:!0,hitTolerance:0,init:void 0,label:Object.assign({},W.defaults.label),rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,xMax:void 0,xMin:void 0,xScaleID:void 0,yMax:void 0,yMin:void 0,yScaleID:void 0,z:0};F.defaultRoutes={borderColor:"color",backgroundColor:"color"};F.descriptors={label:{_fallback:!0}};function qn(e,t,n,o){const{width:r,height:s,centerX:i,centerY:a}=t,d=r/2,l=s/2;if(d<=0||l<=0)return!1;const c=C(n||0),u=Math.cos(c),f=Math.sin(c),h=Math.pow(u*(e.x-i)+f*(e.y-a),2),g=Math.pow(f*(e.x-i)-u*(e.y-a),2);return h/Math.pow(d+o,2)+g/Math.pow(l+o,2)<=1.0001}class ot extends T{inRange(t,n,o,r){const{x:s,y:i,x2:a,y2:d,width:l}=this.getProps(["x","y","x2","y2","width"],r),c=(this.options.borderWidth+this.options.hitTolerance)/2;return o!=="x"&&o!=="y"?He({x:t,y:n},this.getCenterPoint(r),l/2,c):te(o==="y"?{start:i,end:d,value:n}:{start:s,end:a,value:t},c)}getCenterPoint(t){return I(this,t)}draw(t){const n=this.options,o=n.borderWidth;if(n.radius<.1)return;t.save(),t.fillStyle=n.backgroundColor,_(t,n);const r=x(t,n);Je(t,this,this.centerX,this.centerY),r&&!Z(n.pointStyle)&&(t.shadowColor=n.borderShadowColor,t.stroke()),t.restore(),n.borderWidth=o}resolveElementProperties(t,n){const o=pe(t,n);return o.initProperties=Y(t,o,n),o}}ot.id="pointAnnotation";ot.defaults={adjustScaleRange:!0,backgroundShadowColor:"transparent",borderDash:[],borderDashOffset:0,borderShadowColor:"transparent",borderWidth:1,display:!0,hitTolerance:0,init:void 0,pointStyle:"circle",radius:10,rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,xAdjust:0,xMax:void 0,xMin:void 0,xScaleID:void 0,xValue:void 0,yAdjust:0,yMax:void 0,yMin:void 0,yScaleID:void 0,yValue:void 0,z:0};ot.defaultRoutes={borderColor:"color",backgroundColor:"color"};class rt extends T{inRange(t,n,o,r){if(o!=="x"&&o!=="y")return this.options.radius>=.1&&this.elements.length>1&&Kn(this.elements,t,n,r);const s=O({x:t,y:n},this.getCenterPoint(r),C(-this.options.rotation)),i=this.elements.map(l=>o==="y"?l.bY:l.bX),a=Math.min(...i),d=Math.max(...i);return s[o]>=a&&s[o]<=d}getCenterPoint(t){return I(this,t)}draw(t){const{elements:n,options:o}=this;t.save(),t.beginPath(),t.fillStyle=o.backgroundColor,_(t,o);const r=x(t,o);let s=!0;for(const i of n)s?(t.moveTo(i.x,i.y),s=!1):t.lineTo(i.x,i.y);t.closePath(),t.fill(),r&&(t.shadowColor=o.borderShadowColor,t.stroke()),t.restore()}resolveElementProperties(t,n){const o=pe(t,n),{sides:r,rotation:s}=n,i=[],a=2*p/r;let d=s*Gt;for(let l=0;l<r;l++,d+=a){const c=Jn(o,n,d);c.initProperties=Y(t,o,n),i.push(c)}return o.elements=i,o}}rt.id="polygonAnnotation";rt.defaults={adjustScaleRange:!0,backgroundShadowColor:"transparent",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderShadowColor:"transparent",borderWidth:1,display:!0,hitTolerance:0,init:void 0,point:{radius:0},radius:10,rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,sides:3,xAdjust:0,xMax:void 0,xMin:void 0,xScaleID:void 0,xValue:void 0,yAdjust:0,yMax:void 0,yMin:void 0,yScaleID:void 0,yValue:void 0,z:0};rt.defaultRoutes={borderColor:"color",backgroundColor:"color"};function Jn({centerX:e,centerY:t},{radius:n,borderWidth:o,hitTolerance:r},s){const i=(o+r)/2,a=Math.sin(s),d=Math.cos(s),l={x:e+a*n,y:t-d*n};return{type:"point",optionScope:"point",properties:{x:l.x,y:l.y,centerX:l.x,centerY:l.y,bX:e+a*(n+i),bY:t-d*(n+i)}}}function Kn(e,t,n,o){let r=!1,s=e[e.length-1].getProps(["bX","bY"],o);for(const i of e){const a=i.getProps(["bX","bY"],o);a.bY>n!=s.bY>n&&t<(s.bX-a.bX)*(n-a.bY)/(s.bY-a.bY)+a.bX&&(r=!r),s=a}return r}const A={box:W,doughnutLabel:nt,ellipse:F,label:V,line:U,point:ot,polygon:rt};Object.keys(A).forEach(e=>{Oe.describe(`elements.${A[e].id}`,{_fallback:"plugins.annotation.common"})});const Gn={update:Object.assign},Qn=St.concat(K),qt=(e,t)=>R(t)?bt(e,t):e,gt=e=>e==="color"||e==="font";function kt(e="line"){return A[e]?e:(console.warn(`Unknown annotation type: '${e}', defaulting to 'line'`),"line")}function Zn(e,t,n,o){const r=eo(e,n.animations,o),s=t.annotations,i=ro(t.elements,s);for(let a=0;a<s.length;a++){const d=s[a],l=Se(i,a,d.type),c=d.setContext(oo(e,l,i,d)),u=l.resolveElementProperties(e,c);u.skip=to(u),"elements"in u&&(no(l,u.elements,c,r),delete u.elements),w(l.x)||Object.assign(l,u),Object.assign(l,u.initProperties),u.options=Me(c),r.update(l,u)}}function to(e){return isNaN(e.x)||isNaN(e.y)}function eo(e,t,n){return n==="reset"||n==="none"||n==="resize"?Gn:new Ee(e,t)}function no(e,t,n,o){const r=e.elements||(e.elements=[]);r.length=t.length;for(let s=0;s<t.length;s++){const i=t[s],a=i.properties,d=Se(r,s,i.type,i.initProperties),l=n[i.optionScope].override(i);a.options=Me(l),o.update(d,a)}}function Se(e,t,n,o){const r=A[kt(n)];let s=e[t];return(!s||!(s instanceof r))&&(s=e[t]=new r,Object.assign(s,o)),s}function Me(e){const t=A[kt(e.type)],n={};n.id=e.id,n.type=e.type,n.drawTime=e.drawTime,Object.assign(n,bt(e,t.defaults),bt(e,t.defaultRoutes));for(const o of Qn)n[o]=e[o];return n}function bt(e,t){const n={};for(const o of Object.keys(t)){const r=t[o],s=e[o];gt(o)&&L(s)?n[o]=s.map(i=>qt(i,r)):n[o]=qt(s,r)}return n}function oo(e,t,n,o){return t.$context||(t.$context=Object.assign(Object.create(e.getContext()),{element:t,get elements(){return n.filter(r=>r&&r.options)},id:o.id,type:"annotation"}))}function ro(e,t){const n=t.length,o=e.length;if(o<n){const r=n-o;e.splice(o,0,...new Array(r))}else o>n&&e.splice(n,o-n);return e}var io="3.1.0";const k=new Map,Jt=e=>e.type!=="doughnutLabel",so=St.concat(K);var ao={id:"annotation",version:io,beforeRegister(){Be("chart.js","4.0",st.version)},afterRegister(){st.register(A)},afterUnregister(){st.unregister(A)},beforeInit(e){k.set(e,{annotations:[],elements:[],visibleElements:[],listeners:{},listened:!1,moveListened:!1,hooks:{},hooked:!1,hovered:[]})},beforeUpdate(e,t,n){const o=k.get(e),r=o.annotations=[];let s=n.annotations;R(s)?Object.keys(s).forEach(i=>{const a=s[i];R(a)&&(a.id=i,r.push(a))}):L(s)&&r.push(...s),Mn(r.filter(Jt),e.scales)},afterDataLimits(e,t){const n=k.get(e);Sn(e,t.scale,n.annotations.filter(Jt).filter(o=>o.display&&o.adjustScaleRange))},afterUpdate(e,t,n){const o=k.get(e);pn(e,o,n),Zn(e,o,n,t.mode),o.visibleElements=o.elements.filter(r=>!r.skip&&r.options.display),Cn(e,o,n)},beforeDatasetsDraw(e,t,n){B(e,"beforeDatasetsDraw",n.clip)},afterDatasetsDraw(e,t,n){B(e,"afterDatasetsDraw",n.clip)},beforeDatasetDraw(e,t,n){B(e,t.index,n.clip)},beforeDraw(e,t,n){B(e,"beforeDraw",n.clip)},afterDraw(e,t,n){B(e,"afterDraw",n.clip)},beforeEvent(e,t,n){const o=k.get(e);mn(o,t.event,n)&&(t.changed=!0)},afterDestroy(e){k.delete(e)},getAnnotations(e){const t=k.get(e);return t?t.elements:[]},_getAnnotationElementsAtEventForMode(e,t,n){return mt(e,t,n)},defaults:{animations:{numbers:{properties:["x","y","x2","y2","width","height","centerX","centerY","pointX","pointY","radius"],type:"number"},colors:{properties:["backgroundColor","borderColor"],type:"color"}},clip:!0,interaction:{mode:void 0,axis:void 0,intersect:void 0},common:{drawTime:"afterDatasetsDraw",init:!1,label:{}}},descriptors:{_indexable:!1,_scriptable:e=>!so.includes(e)&&e!=="init",annotations:{_allKeys:!1,_fallback:(e,t)=>`elements.${A[kt(t.type)].id}`},interaction:{_fallback:!0},common:{label:{_indexable:gt,_fallback:!0},_indexable:gt}},additionalOptionScopes:[""]};function B(e,t,n){const{ctx:o,chartArea:r}=e,s=k.get(e);n&&ke(o,r);const i=lo(s.visibleElements,t).sort((a,d)=>a.element.options.z-d.element.options.z);for(const a of i)co(o,r,s,a);n&&Ae(o)}function lo(e,t){const n=[];for(const o of e)if(o.options.drawTime===t&&n.push({element:o,main:!0}),o.elements&&o.elements.length)for(const r of o.elements)r.options.display&&r.options.drawTime===t&&n.push({element:r});return n}function co(e,t,n,o){const r=o.element;o.main?(Lt(n,r,"beforeDraw"),r.draw(e,t),Lt(n,r,"afterDraw")):r.draw(e,t)}class uo extends Ie{KEY_LABELS={institutionsAccessLAC:"Acceso a instituciones",institutionsDepthLAC:"Profundidad de instituciones",institutionsEfficiencyLAC:"Eficiencia de instituciones",marketsAccessLAC:"Acceso a mercados",marketsDepthLAC:"Profundidad de mercados",marketsEfficiencyLAC:"Eficiencia de mercados",institutionsAccessEUC:"Acceso a instituciones",institutionsDepthEUC:"Profundidad de instituciones",institutionsEfficiencyEUC:"Eficiencia de instituciones",marketsAccessEUC:"Acceso a mercados",marketsDepthEUC:"Profundidad de mercados",marketsEfficiencyEUC:"Eficiencia de mercados"};async initialize(){super.initialize(),this.register(Re,Le,ao)}getType(){return"matrix"}getData(){this.rawData.reverse();const t=this.rawData.length;Object.keys(this.rawData[0]).length-1;const n=[];this.rawData.forEach(i=>{[1,2,3,4,5,6].forEach(a=>{const[d,l]=Object.entries(i)[a];n.push({x:this.t(this.KEY_LABELS[d]),y:i.country,v:l})})});const o=[];this.rawData.forEach(i=>{[8,9,10,11,12,13].forEach(a=>{const[d,l]=Object.entries(i)[a];o.push({x:this.t(this.KEY_LABELS[d]),y:i.country,v:l})})});function r(i){i=Math.max(-1,Math.min(1,i));const a={r:248,g:107,b:109},d={r:99,g:190,b:123},l={r:255,g:255,b:255};let c,u,f;if(i<0){const h=i+1;c=Math.round(a.r+h*(l.r-a.r)),u=Math.round(a.g+h*(l.g-a.g)),f=Math.round(a.b+h*(l.b-a.b))}else{const h=i;c=Math.round(l.r+h*(d.r-l.r)),u=Math.round(l.g+h*(d.g-l.g)),f=Math.round(l.b+h*(d.b-l.b))}return`rgb(${c}, ${u}, ${f})`}return{datasets:[{label:this.t("Índice de Desarrollo de Mercados Financieros"),data:n,backgroundColor(i){const a=parseFloat(i.dataset.data[i.dataIndex].v);return r(a)},hoverBackgroundColor(i){const a=parseFloat(i.dataset.data[i.dataIndex].v);return r(a)},width:({chart:i})=>i.chartArea?i.chartArea.width/2/6-1:10,height:({chart:i})=>i.chartArea?i.chartArea.height/t-1:10,xAxisID:"xLAC"},{label:this.t("Índice de Desarrollo de Mercados Financieros"),data:o,backgroundColor(i){const a=parseFloat(i.dataset.data[i.dataIndex].v);return r(a)},hoverBackgroundColor(i){const a=parseFloat(i.dataset.data[i.dataIndex].v);return r(a)},width:({chart:i})=>i.chartArea?i.chartArea.width/2/6-1:10,height:({chart:i})=>i.chartArea?i.chartArea.height/t-1:10,xAxisID:"xEUC"}]}}getOptions(){return this.mergeOptions(super.getOptions(),{maintainAspectRatio:!0,aspectRatio:"1",scales:{xEUC:{ticks:{display:!0,autoSkip:!1,maxRotation:90,minRotation:90,labelOffset:14},grid:{display:!0},title:{display:!0,text:vt(this.t("Diferencia respecto al valor promedio de Estados Unidos y Canadá"),36),align:"center",font:{size:12,weight:500},padding:8},type:"category",backgroundColor:"rgba(0, 0, 0, 0.05)",position:"top",offset:!0,stacked:!0,stack:"strip"},xLAC:{ticks:{display:!0,autoSkip:!1,maxRotation:90,minRotation:90,labelOffset:14},grid:{display:!0},title:{display:!0,align:"center",text:vt(this.t("Diferencia respecto al valor promedio de la década de 1980"),36),font:{size:12,weight:500},padding:10},type:"category",backgroundColor:"rgba(0, 0, 0, 0.025)",position:"top",offset:!0,stacked:!0,stack:"strip"},y:{offset:!0,ticks:{stepSize:1,autoSkip:!1},grid:{display:!0},type:"category",labels:this.rawData.map(t=>t.country).reverse()},x:{display:!1}},plugins:{htmlLegend:{display:!1},legend:{display:!1},tooltip:{callbacks:{title(){return""},label:this.getTooltipLabelFormatter()}},annotation:{annotations:[this.createSeparator(15.5,"horizontal","xLAC"),this.createSeparator(25.5,"horizontal","xLAC"),this.createSeparator(15.5,"horizontal","xEUC"),this.createSeparator(25.5,"horizontal","xEUC"),this.createSeparator(-.5,"vertical","y")]},datalabels:{color:"#374151",font:{weight:"normal",size:11},formatter:this.getDatalabelsFormatter()}}})}getTooltipLabelFormatter(){const t=this.getFormatOptions();return n=>{const o=n.dataset.data[n.dataIndex];return[o.y,o.x,Et(o.v,t)]}}getDatalabelsFormatter(){const t=this.getFormatOptions();return(n,o)=>Et(o.dataset.data[o.dataIndex].v,t)}createSeparator(t,n="horizontal",o="x"){const r=n==="horizontal";return{type:"line",[`${r?"yMin":"xMin"}`]:t,[`${r?"yMax":"xMax"}`]:t,borderColor:"#374151",borderWidth:1,[`${r?"xScaleID":"yScaleID"}`]:o}}getPlugins(){return[...super.getPlugins(),je]}}function Kt(){try{new uo("C1-G11a")}catch{}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Kt):Kt();
