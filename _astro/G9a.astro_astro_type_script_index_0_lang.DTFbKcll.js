import{B as g,f as y}from"./BaseChart.BPIYNeR_.js";import{g as d}from"./colors.DR0mxEkc.js";class f extends g{getDefaultCountries(){return["Uruguay","Barbados","Chile","Bahamas","San Vicente","Dominica","Costa Rica","Santa Lucía","Granada","Jamaica","Cuba","Trinidad y Tobago","Colombia","Guyana","Surinam","Argentina","Brasil","Rep. Dominicana","Panamá","Ecuador","Perú","El Salvador","México","Bolivia","Paraguay","Guatemala","Honduras","Francia","Estados Unidos","Reino Unido","Japón","Nueva Zelanda"].map(a=>this.t(a))}colorByRegion=null;getColorByRegion(a){if(!this.colorByRegion){const i=["América Latina y el Caribe","OCDE","Otros países"].map(n=>this.t(n)),e=[d(0),d(2),d(1)];this.colorByRegion=Object.fromEntries(i.map((n,o)=>[n,e[o]]))}return this.colorByRegion[a]}async initialize(){await super.initialize(),this.setupCountriesSelect(),this.updateChart()}setupCountriesSelect(){const a=[...new Set(this.rawData.map(e=>e.country))].sort(),i=this.getDefaultCountries();this.countriesSelect=document.querySelector(`#countries-select-list-${this.chartId}`),this.countriesSelect&&a.forEach(e=>{const n=document.createElement("li"),o=document.createElement("label");o.classList.add("label","cursor-pointer");const r=document.createElement("span");r.classList.add("label-text"),r.textContent=e;const c=document.createElement("input");c.type="checkbox",c.classList.add("checkbox","checkbox-primary","checkbox-sm"),c.value=e,i.includes(e)&&(c.checked=!0),o.appendChild(r),o.appendChild(c),n.appendChild(o),n.addEventListener("change",()=>this.updateChart()),this.countriesSelect.appendChild(n)})}updateChart(){const a=Array.from(this.countriesSelect.querySelectorAll("input:checked")).map(i=>i.value);a.length>0?(this.chart.data=this.getDataFromCountries(a),this.chart.legendNeedsUpdate=!0,this.chart.update()):(this.chart.data.datasets.splice(0,1/0),this.chart.data.labels.splice(0,1/0),this.chart.legendNeedsUpdate=!0,this.chart.update())}getDataFromCountries(a){const i=this.rawData.filter(t=>a.includes(t.country)),e=i.reduce((t,s)=>(t[s.region]||(t[s.region]=[]),t[s.region].push(s),t),{});for(const t in e)e[t].sort((s,l)=>s.index-l.index);i.length=0;const n=Object.keys(e).sort();for(const t of n)i.push(...e[t]);const o=[],r={};for(const t of n)r[t]=e[t].length;const c=Object.values(r).reduce((t,s)=>t+s,0);let u=0;return n.forEach(t=>{const s=Array(c).fill(null);e[t].forEach((l,m)=>{s[u+m]=l.index}),o.push({label:t,data:s,backgroundColor:this.getColorByRegion(t),pointStyle:"rect"}),u+=r[t]}),{labels:i.map(t=>t.country),datasets:o}}getType(){return"bar"}getData(){return[]}getOptions(){return this.mergeOptions(super.getOptions(),{scales:{x:{stacked:!0,ticks:{minRotation:90,maxRotation:90}},y:{max:100,title:{display:!0,text:this.t("Índice de percepción de la corrupción")}}},plugins:{tooltip:{boxPadding:4,callbacks:{label:a=>{const i=y(a.dataset.data[a.dataIndex],this.getFormatOptions());return`${this.t("Índice")}: ${i}`}}}}})}}function h(){try{new f("C5-G9a")}catch{}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",h):h();
