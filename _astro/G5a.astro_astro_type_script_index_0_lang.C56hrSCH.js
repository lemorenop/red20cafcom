import{B as y,f as g,w as f}from"./BaseChart.BPIYNeR_.js";import{g as l}from"./colors.DR0mxEkc.js";class b extends y{getDefaultCountries(){return["Argentina","Belice","Bolivia","Brasil","Chile","Colombia","Costa Rica","Ecuador","El Salvador","Guatemala","Honduras","México","Nicaragua","Panamá","Paraguay","Perú","Surinam","Uruguay","Venezuela","Antigua y Barbuda","Bahamas","Barbados","Cuba","Dominica","Rep. Dominicana","Jamaica","Trinidad y Tobago","Francia","Alemania","Japón","Reino Unido","Estados Unidos"].map(t=>this.t(t))}averagesIndices={};averageByRegion=null;getAverageByRegion(t){if(!this.averageByRegion){const i=["América Latina","Caribe","OCDE","Otros países"].map(n=>this.t(n)),a=[1.29,.96,1.76,null];this.averageByRegion=Object.fromEntries(i.map((n,s)=>[n,a[s]]))}return this.averageByRegion[t]}getAverageDataByRegion(t){return{country:`${this.t("Promedio")} ${t}`,region:t,index:this.getAverageByRegion(t)}}colorByRegion=null;getColorByRegion(t){if(!this.colorByRegion){const i=["América Latina","Caribe","OCDE","Otros países"].map(n=>this.t(n)),a=[l(0),l(3),l(2),l(1)];this.colorByRegion=Object.fromEntries(i.map((n,s)=>[n,a[s]]))}return this.colorByRegion[t]}async initialize(){await super.initialize(),this.setupCountriesSelect(),this.updateChart()}setupCountriesSelect(){const t=[...new Set(this.rawData.map(a=>a.country))].sort(),i=this.getDefaultCountries();this.countriesSelect=document.querySelector(`#countries-select-list-${this.chartId}`),this.countriesSelect&&t.forEach(a=>{const n=document.createElement("li"),s=document.createElement("label");s.classList.add("label","cursor-pointer");const o=document.createElement("span");o.classList.add("label-text"),o.textContent=a;const c=document.createElement("input");c.type="checkbox",c.classList.add("checkbox","checkbox-primary","checkbox-sm"),c.value=a,i.includes(a)&&(c.checked=!0),s.appendChild(o),s.appendChild(c),n.appendChild(s),n.addEventListener("change",()=>this.updateChart()),this.countriesSelect.appendChild(n)})}updateChart(){const t=Array.from(this.countriesSelect.querySelectorAll("input:checked")).map(i=>i.value);t.length>0?(this.chart.data=this.getDataFromCountries(t),this.chart.legendNeedsUpdate=!0,this.chart.update()):(this.chart.data.datasets.splice(0,1/0),this.chart.data.labels.splice(0,1/0),this.chart.legendNeedsUpdate=!0,this.chart.update())}getDataFromCountries(t){const i=this.rawData.filter(e=>t.includes(e.country)),a=i.reduce((e,r)=>(e[r.region]||(e[r.region]=[]),e[r.region].push(r),e),{});for(const e in a)a[e].sort((d,h)=>h.index-d.index),this.getAverageDataByRegion(e).index!==null&&a[e].push(this.getAverageDataByRegion(e));i.length=0;const n=Object.keys(a).sort();for(const e of n)i.push(...a[e]);const s=[],o={};for(const e of n)o[e]=a[e].length;const c=Object.values(o).reduce((e,r)=>e+r,0);let u=0;return n.forEach(e=>{const r=Array(c).fill(null);a[e].forEach((d,h)=>{r[u+h]=d.index}),s.push({label:e,data:r,backgroundColor:this.getColorByRegion(e),pointStyle:"rect"}),u+=o[e],this.getAverageByRegion(e)!==null&&(this.averagesIndices[e]=u-1)}),{labels:i.map(e=>e.country),datasets:s}}getType(){return"bar"}getData(){return[]}getOptions(){return this.mergeOptions(super.getOptions(),{responsive:!0,scales:{x:{stacked:!0,ticks:{minRotation:90,maxRotation:90}},y:{title:{display:!0,text:this.t("Índice de facilitación del comercio")},ticks:{callback:t=>g(t,{...this.getFormatOptions(),decimalPlaces:1})}}},plugins:{tooltip:{boxPadding:4,callbacks:{label:t=>{const i=g(t.dataset.data[t.dataIndex],this.getFormatOptions());return`${this.t("Índice")}: ${i}`}}},datalabels:{anchor:"end",align:"top",rotation:"-90",offset:4,formatter:(t,i)=>t&&Object.values(this.averagesIndices).includes(i.dataIndex)?g(t,this.getFormatOptions()):null}}})}formatDataLabel(t){return parseFloat(t).toFixed(2)}getPlugins(){return[...super.getPlugins(),f]}}function p(){try{new b("C5-G5a")}catch{}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",p):p();
