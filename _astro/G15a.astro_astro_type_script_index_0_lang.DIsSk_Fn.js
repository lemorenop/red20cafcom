import{B as p}from"./BaseChart.BPIYNeR_.js";import{g as h}from"./colors.DR0mxEkc.js";const u={id:"verticalLineSegment",beforeDatasetsDraw:(i,a,t)=>{const{ctx:e,data:l}=i,o=new Map;l.datasets.forEach(n=>{n.data.forEach(s=>{o.has(s.x)||o.set(s.x,[]),o.get(s.x).push(parseFloat(s.y))})}),e.save(),e.strokeStyle="#3B254F",e.lineWidth=2,o.entries().forEach(([n,s])=>{let r=Math.min(...s),c=Math.max(...s);const g=i.scales.x.getPixelForValue(n);r=i.scales.y.getPixelForValue(r),c=i.scales.y.getPixelForValue(c),e.beginPath(),e.moveTo(g,r),e.lineTo(g,c),e.stroke()}),e.restore()}};class y extends p{setupControls(){this.setupRegionSelect(),this.setupAgeSelect()}setupRegionSelect(){const a=[...new Set(this.rawData.map(t=>t.region))].sort();this.regionSelect=this.container.querySelector("#region-select"),this.regionSelect&&(a.forEach(t=>{const e=document.createElement("option");e.value=t,e.textContent=t,this.regionSelect.appendChild(e)}),this.regionSelect.addEventListener("change",this.updateChart.bind(this)))}setupAgeSelect(){const a=[...new Set(this.rawData.map(t=>t.age))].sort();this.ageSelect=this.container.querySelector("#age-select"),this.ageSelect&&(a.forEach(t=>{const e=document.createElement("option");e.value=t,e.textContent=this.t("Proporción de la población con {age} años o más",{age:t}),this.ageSelect.appendChild(e)}),this.ageSelect.addEventListener("change",this.updateChart.bind(this)))}updateChart(){const a=this.ageSelect.value,t=this.regionSelect.value;t&&a&&(this.chart.data=this.getDataByRegionAndAge(t,a),this.chart.forceLegendUpdate())}getDataByRegion(a,t){return this.rawData.filter(e=>e.region==a).sort((e,l)=>e[t].localeCompare(l[t]))}getDataByRegionAndAge(a,t){const e=this.getDataByRegion(a,"country"),o=[...new Set(e.map(n=>n.year))].sort().map((n,s)=>({type:"scatter",label:n,data:e.filter(r=>r.year===n&&r.age===t).map(r=>({x:r.country,y:r.percentage})),backgroundColor:h(s),borderColor:h(s),borderWidth:1,pointStyle:"circle",pointHoverRadius:4,radius:3}));return[...new Set(e.map(n=>n.country))].forEach(n=>{e.filter(s=>s.country===n&&s.age===t).map(s=>parseFloat(s.percentage))}),{datasets:[...o]}}getType(){return"scatter"}getData(){return this.getDataByRegionAndAge(this.t("América Latina"),"65")}getOptions(){return this.mergeOptions(super.getOptions(),{interaction:{mode:"index",intersect:!1},scales:{x:{type:"category",offset:!0},y:{type:"linear",ticks:{callback:this.ticksAsPercentage()}}},plugins:{htmlLegend:{display:!1},legend:{display:!0,position:"bottom",labels:{usePointStyle:!0,boxWidth:6,boxHeight:6},onClick:a=>{a.native.preventDefault()}},tooltip:{itemSort:(a,t)=>parseInt(t.dataset.label,10)-parseInt(a.dataset.label,10),labelAsPercentage:!0}}})}getPlugins(){return[...super.getPlugins(),u]}}function d(){try{new y("C1-G15a")}catch{}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",d):d();
