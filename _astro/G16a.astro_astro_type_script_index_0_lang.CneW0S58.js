import{B as o}from"./BarChart.KOKhGWM3.js";import{g as r}from"./colors.DR0mxEkc.js";import{f as l}from"./BaseChart.BPIYNeR_.js";class d extends o{defaultRegion="AmÃ©rica del Sur";defaultYear="1950";scaleStepSize=.2;maxValuesByRegion=new Map;setupControls(){this.setupRegionSelect(),this.setupYearSlider()}setupRegionSelect(){const t=[...new Set(this.rawData.map(e=>e.region))].sort();this.regionSelect=this.container.querySelector("#region-select"),this.regionSelect&&(t.forEach(e=>{const a=document.createElement("option");a.value=e,a.textContent=e,this.regionSelect.appendChild(a)}),this.regionSelect.value=this.t(this.defaultRegion),this.regionSelect.addEventListener("change",this.updateChart.bind(this)))}setupYearSlider(){window.yearSliders?.has(this.chartId)?this.connectYearSlider():window.addEventListener("yearSlidersReady",()=>this.connectYearSlider())}connectYearSlider(){this.yearSlider=window.yearSliders.get(this.chartId),this.yearSlider&&this.yearSlider.onYearUpdate(t=>{this.updateChart()})}getDataByRegion(t){return this.rawData.filter(e=>e.region==t).sort((e,a)=>e.country.localeCompare(a.country))}getMaxValueByRegion(t){let e=this.maxValuesByRegion.get(t);return e||(e=Math.max(...this.getDataByRegion(t).map(a=>a.dependencyRate)),e=Math.ceil(e/this.scaleStepSize)*this.scaleStepSize),e}updateChart(){const t=this.regionSelect.value||this.t(this.defaultRegion),e=this.yearSlider.value||this.defaultYear;t&&e&&(this.chart.data=this.getChartDataByRegionAndYear(t,e),this.chart.options.scales.y.max=this.getMaxValueByRegion(t),this.chart.update("none"))}getChartDataByRegionAndYear(t,e){const a=this.getDataByRegion(t).filter(i=>i.year===e.toString());return{labels:a.map(i=>i.country),datasets:[{label:this.t("Tasa de dependencia"),data:a.map(i=>i.dependencyRate),backgroundColor:r(0),borderColor:r(0)}]}}getData(){return this.getChartDataByRegionAndYear(this.t(this.defaultRegion),this.defaultYear)}getOptions(){return this.mergeOptions(super.getOptions(),{scales:{x:{ticks:{autoSkip:!1}},y:{min:0,max:1.2,ticks:{autoSkip:!1,stepSize:this.scaleStepSize},grid:{color:t=>t.tick.value>.9&&t.tick.value<1.1?"rgba(0, 0, 0, 0.3)":"rgba(0, 0, 0, 0.1)"}}},plugins:{htmlLegend:{display:!1},legend:{display:!1},datalabels:{anchor:"end",align:"top",formatter:this.getDatalabelsFormatter()}}})}getDatalabelsFormatter(){const t=this.getFormatOptions();return(e,a)=>l(e,t)}}function s(){try{new d("C1-G16a")}catch{}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",s):s();
